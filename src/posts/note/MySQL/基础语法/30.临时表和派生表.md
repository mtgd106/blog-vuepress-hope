---
title: 临时表和派生表
author: 
  name: 北斗星司
category: 
  - 数据库
tag: 
  - MySQL
date: 2023-10-23 15:08:32
icon: file
---

<!-- permalink: /MySQL/基础语法/临时表和派生表  -->

## 临时表(temporary table)

### 简介

   在MySQL中，临时表是一种特殊类型的表，它允许我们存储一个临时结果集，可以在单个会话中多次重用。

### 功能

   1.当会话结束或连接终止时，MySQL会自动删除临时表。当不再使用临时表时，也可以使用drop table语句来显式删除。 

   2.一个临时表只能由创建它的客户机访问。不同的客户端可以创建具有相同名称的临时表，而不会导致错误，因为只有创建临时表的客户端才能看到它。但是，**在同一个会话中，两个临时表不能重名。**

   3.**临时表可以与数据库中的普通表具有相同的名称。** 

&nbsp;&nbsp;&nbsp;例：如果在数据库中创建一个名为`employees`的临时表，则现有的`employees`表将变得无法访问。 

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;对`employees`表发出的每个查询都会指向`employees`临时表。 当删除临时表时，永久表可以再次访问。

### 使用

  1.创建临时表

```sql
create temporary table 临时表名称

select ......

;         -- select语句查询出的数据存放到临时表中
```

   2.删除临时表

```sql
drop temporary table 临时表名称;
```



## 派生表(derived table)

  派生表是从select语句返回的虚拟表。派生表类似于临时表，但派生表更简单，因为它不需要创建临时表的步骤。

  派生表和子查询通常互换使用。当select语句的from子句中使用独立子查询时，就可以成为派生表。

  注意：独立子查询是一个子查询，可独立于包含该语句的执行语句。

​          与子查询不同，派生表必须具有别名，以便稍后在查询中引用其名称。 如果派生表没有别名，MySQL将发出以下错误：

```sql
Every derived table must have its own alias.
```



## 区别

  派生表 和 临时表 在数据库中都是用于处理临时数据的概念，但它们在定义、作用范围和使用方式上有以下区别：

   1.定义和语法

&nbsp;&nbsp;&nbsp;派生表是通过在查询语句内联视图的方式来创建的表，在FROM子句中直接使用 SELECT 语句定义。

&nbsp;&nbsp;&nbsp;临时表是在数据库中显式地创建的一个临时表结构，可以通过CREATE TABLE语句来定义。

   2.数据存储和作用范围

&nbsp;&nbsp;&nbsp;派生表不会在数据库中存储，它仅仅在查询执行期间存在，作为查询结果的一部分。

&nbsp;&nbsp;&nbsp;临时表在数据库内有真正的存储空间，可以在多个查询之间共享，也可以在当前数据库会话（session）中使用。

   3.数据处理

&nbsp;&nbsp;&nbsp;派生表是根据查询的要求在执行查询时动态创建的，它通常用于处理复杂的查询、嵌套查询和多次引用的情况。

&nbsp;&nbsp;&nbsp;临时表是在需要时显式创建的，可以像常规表一样进行插入、更新和删除操作。

   4.生命周期

&nbsp;&nbsp;&nbsp;派生表的生命周期仅限于查询执行期间，一旦查询结束，派生表就不再存在。

&nbsp;&nbsp;&nbsp;临时表的生命周期可以通过显式删除表或当前会话结束来结束。

  总结：**派生表是在查询中动态生成的临时表，仅在查询执行期间存在，不存储数据。**

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;**临时表是显式创建的临时表结构，可以存储数据，并在当前会话中持续存在。**